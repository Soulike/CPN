'use strict';function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),k=h.value}catch(l){return void d(l)}return h.done?void c(k):Promise.resolve(k).then(function(l){e('next',l)},function(l){e('throw',l)})}return e('next')})}}var mapping={};$(_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d,e,f,g;return regeneratorRuntime.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,getAsync('/cpn/nodes/getAll');case 2:if(b=k.sent.data,c=b.code,d=b.msg,e=b.data,c===CODE.SUCCESS){for(f=e.nodes,DEBUG&&(console.log('\u670D\u52A1\u5668\u53D1\u9001\u8282\u70B9\u6570\u636E'),console.log(f)),g=0;g<f.length;g++)mapping[f[g].trim()]=g;DEBUG&&(console.log('\u524D\u7AEF\u6620\u5C04'),console.log(mapping))}case 7:case'end':return k.stop();}},a,void 0)}))),$(function(){var a=io('http://'+SERVER.DOMAIN+':'+SERVER.PORT);a.on('connect',function(){console.log('socket \u8FDE\u63A5\u6210\u529F')}),a.on('disconnect',function(){console.log('socket \u65AD\u5F00\uFF0C\u8FDB\u884C\u91CD\u8FDE')}),a.on('nodeStatus',function(b){var c,d,e={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var m,l=b[Symbol.iterator]();!(_iteratorNormalCompletion=(m=l.next()).done);_iteratorNormalCompletion=!0){var n=m.value,o=n.startNode,p=n.endNode;c=mapping[o],d=mapping[p],e[c+'-'+d]=!0}}catch(o){_didIteratorError=!0,_iteratorError=o}finally{try{!_iteratorNormalCompletion&&l.return&&l.return()}finally{if(_didIteratorError)throw _iteratorError}}for(var f in e)if(e.hasOwnProperty(f)){var g=f.split('-');Object.is(e[g[1]+'-'+g[0]],void 0)?delete e[f]:parseInt(g[0])>parseInt(g[1])&&delete e[f]}DEBUG&&(console.log('\u65B0\u7684\u8FDE\u63A5\u72B6\u6001'),console.log(e));for(var h=0;42>h;h++)for(var k=h+1;48>k&&6>=k-h;k++)(1==k-h||6==k-h)&&(Object.is(e[h+'-'+k],void 0)?$('.line[data-connectnodes='+h+'-'+k+']').removeClass('connected'):!0===e[h+'-'+k]&&$('.line[data-connectnodes='+h+'-'+k+']').addClass('connected'))})}),$(function(){if(DEBUG){var a=$('.icon'),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var c,d,b=a[Symbol.iterator]();!(_iteratorNormalCompletion2=(c=b.next()).done);_iteratorNormalCompletion2=!0)d=c.value,$(d).text($(d).attr('data-nodeid'))}catch(e){_didIteratorError2=!0,_iteratorError2=e}finally{try{!_iteratorNormalCompletion2&&b.return&&b.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}});