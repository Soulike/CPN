'use strict';function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function f(g,h){try{var k=b[g](h),l=k.value}catch(m){return void d(m)}return k.done?void c(l):Promise.resolve(l).then(function(m){f('next',m)},function(m){f('throw',m)})}return f('next')})}}$(_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d,f,g,h,k,l,m,n,o,p,q;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,getAllNodesInfo();case 3:if(b=s.sent,c=b.getAll,d=b.getType,c.code!==CODE.SUCCESS){s.next=13;break}for(f=c.data.nodes,DEBUG&&(console.log('\u670D\u52A1\u5668\u53D1\u9001\u8282\u70B9\u6570\u636E'),console.log(f)),g=0;g<f.length;g++)originalIdToPageId[f[g].trim()]=g,pageIdToOriginalId[g]=f[g].trim();DEBUG&&(console.log('\u524D\u7AEF\u6620\u5C04'),console.log(originalIdToPageId)),s.next=15;break;case 13:return s.next=15,showNotice(c.msg);case 15:if(d.code!==CODE.SUCCESS){s.next=24;break}for(n in h=$('.icon'),h.attr('data-deviceType','0'),h.css('background-image','url(\'./images/0.png\')'),k=d.data,l=DEVICE,m=l.TYPE,k)k.hasOwnProperty(n)&&(n=n.trim(),o=originalIdToPageId[n],p=k[n],q=$('.icon[data-nodeid='+o+']'),q.attr('data-deviceType',k[n]),q.css('background-image','url(\'./images/'+p+'.png\')'));s.next=26;break;case 24:return s.next=26,showNotice(d.msg);case 26:s.next=33;break;case 28:return s.prev=28,s.t0=s['catch'](0),console.log(s.t0),s.next=33,showNotice(MSG.ERROR).catch(function(t){console.log(t)});case 33:case'end':return s.stop();}},a,void 0,[[0,28]])}))),$(function(){var a=io('http://'+SERVER.DOMAIN+':'+SERVER.PORT);a.on('connect',function(){console.log('socket \u8FDE\u63A5\u6210\u529F')}),a.on('disconnect',function(){console.log('socket \u65AD\u5F00\uFF0C\u8FDB\u884C\u91CD\u8FDE')}),a.on('nodeStatus',function(b){DEBUG&&(console.log('\u65B0\u7684\u8FDE\u63A5\u72B6\u6001 (\u539F\u59CB\u6570\u636E)'),console.log(b));var c,d,f={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var l,k=b[Symbol.iterator]();!(_iteratorNormalCompletion=(l=k.next()).done);_iteratorNormalCompletion=!0){var m=l.value,n=m.startNode,o=m.endNode;c=originalIdToPageId[n],d=originalIdToPageId[o],f[c+'-'+d]=!0}}catch(n){_didIteratorError=!0,_iteratorError=n}finally{try{!_iteratorNormalCompletion&&k.return&&k.return()}finally{if(_didIteratorError)throw _iteratorError}}DEBUG&&(console.log('\u65B0\u7684\u8FDE\u63A5\u72B6\u6001'),console.log(f));for(var g=0;42>g;g++)for(var h=g+1;48>h&&6>=h-g;h++)(1==h-g||6==h-g)&&(Object.is(f[g+'-'+h],void 0)?$('.line[data-connectnodes='+g+'-'+h+']').removeClass('connected'):!0===f[g+'-'+h]&&$('.line[data-connectnodes='+g+'-'+h+']').addClass('connected'))}),a.on('nodeType',function(b){var d=$('.icon');d.attr('data-deviceType','0'),d.css('background-image','url(\'./images/0.png\')');var _DEVICE2=DEVICE,c=_DEVICE2.TYPE;for(var f in b)if(b.hasOwnProperty(f)){f=f.trim();var g=originalIdToPageId[f],h=b[f],k=$('.icon[data-nodeid='+g+']');k.attr('data-deviceType',b[f]),k.css('background-image','url(\'./images/'+h+'.png\')')}})});