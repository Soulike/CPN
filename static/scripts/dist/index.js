'use strict';function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function f(g,h){try{var k=b[g](h),l=k.value}catch(m){return void d(m)}return k.done?void c(l):Promise.resolve(l).then(function(m){f('next',m)},function(m){f('throw',m)})}return f('next')})}}$(_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d,f,g,h,k,l,m,n,o,p,q,r,s,t,u,v;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,getAllNodesInfo();case 3:if(b=x.sent,c=b.getAll,d=b.getType,c.code!==CODE.SUCCESS){x.next=13;break}for(f=c.data.nodes,DEBUG&&(console.log('\u670D\u52A1\u5668\u53D1\u9001\u8282\u70B9\u6570\u636E'),console.log(f)),g=0;g<f.length;g++)originalIdToPageId[f[g].trim()]=g,pageIdToOriginalId[g]=f[g].trim();DEBUG&&(console.log('\u524D\u7AEF\u6620\u5C04'),console.log(originalIdToPageId)),x.next=15;break;case 13:return x.next=15,showNotice(c.msg);case 15:if(d.code!==CODE.SUCCESS){x.next=21;break}for(m in h=d.data,k=DEVICE,l=k.TYPE,h)h.hasOwnProperty(m)&&(n=originalIdToPageId[m.trim()],o=$('.icon[data-nodeid='+n+']'),o.attr('data-deviceType',h[m]),o.css('background-image','url(\'./images/'+l[h[m]]+'.png\')'));x.next=23;break;case 21:return x.next=23,showNotice(d.msg);case 23:x.next=30;break;case 25:return x.prev=25,x.t0=x['catch'](0),console.log(x.t0),x.next=30,showNotice(MSG.ERROR).catch(function(y){console.log(y)});case 30:if(x.prev=30,!DEBUG){x.next=49;break}p=$('.icon'),q=p,r=Array.isArray(q),s=0,q=r?q:q[Symbol.iterator]();case 34:if(!r){x.next=40;break}if(!(s>=q.length)){x.next=37;break}return x.abrupt('break',49);case 37:t=q[s++],x.next=44;break;case 40:if(s=q.next(),!s.done){x.next=43;break}return x.abrupt('break',49);case 43:t=s.value;case 44:u=t,v=$(u).attr('data-deviceType'),$(u).text(DEVICE.NAME_FOR_TEST[v]);case 47:x.next=34;break;case 49:return x.finish(30);case 50:case'end':return x.stop();}},a,void 0,[[0,25,30,50]])}))),$(function(){var a=io('http://'+SERVER.DOMAIN+':'+SERVER.PORT);a.on('connect',function(){console.log('socket \u8FDE\u63A5\u6210\u529F')}),a.on('disconnect',function(){console.log('socket \u65AD\u5F00\uFF0C\u8FDB\u884C\u91CD\u8FDE')}),a.on('nodeStatus',function(b){for(var c=void 0,d=void 0,f={},g=b,h=Array.isArray(g),k=0,g=h?g:g[Symbol.iterator]();;){var l;if(h){if(k>=g.length)break;l=g[k++]}else{if(k=g.next(),k.done)break;l=k.value}var _ref5=l,q=_ref5.startNode,r=_ref5.endNode;c=originalIdToPageId[q],d=originalIdToPageId[r],f[c+'-'+d]=!0}for(var m in f)if(f.hasOwnProperty(m)){var n=m.split('-');Object.is(f[n[1]+'-'+n[0]],void 0)?delete f[m]:parseInt(n[0])>parseInt(n[1])&&delete f[m]}DEBUG&&(console.log('\u65B0\u7684\u8FDE\u63A5\u72B6\u6001'),console.log(f));for(var o=0;42>o;o++)for(var p=o+1;48>p&&6>=p-o;p++)(1==p-o||6==p-o)&&(Object.is(f[o+'-'+p],void 0)?$('.line[data-connectnodes='+o+'-'+p+']').removeClass('connected'):!0===f[o+'-'+p]&&$('.line[data-connectnodes='+o+'-'+p+']').addClass('connected'))})});